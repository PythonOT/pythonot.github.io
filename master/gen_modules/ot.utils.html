<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ot.utils &mdash; POT Python Optimal Transport 0.9.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=9dc39874"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ot.weak" href="ot.weak.html" />
    <link rel="prev" title="ot.unbalanced" href="ot.unbalanced.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            POT Python Optimal Transport
              <img src="../_static/logo_dark.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.9.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">POT: Python Optimal Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../all.html">API and modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ot.backend.html">ot.backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.bregman.html">ot.bregman</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.coot.html">ot.coot</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.da.html">ot.da</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.datasets.html">ot.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.dr.html">ot.dr</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.factored.html">ot.factored</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.gaussian.html">ot.gaussian</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.gnn.html">ot.gnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.gromov.html">ot.gromov</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.lp.html">ot.lp</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.optim.html">ot.optim</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.partial.html">ot.partial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.plot.html">ot.plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.regpath.html">ot.regpath</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.sliced.html">ot.sliced</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.smooth.html">ot.smooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.stochastic.html">ot.stochastic</a></li>
<li class="toctree-l2"><a class="reference internal" href="ot.unbalanced.html">ot.unbalanced</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ot.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.check_params"><code class="docutils literal notranslate"><span class="pre">check_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.check_random_state"><code class="docutils literal notranslate"><span class="pre">check_random_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.clean_zeros"><code class="docutils literal notranslate"><span class="pre">clean_zeros()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.cost_normalization"><code class="docutils literal notranslate"><span class="pre">cost_normalization()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.dist"><code class="docutils literal notranslate"><span class="pre">dist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.dist0"><code class="docutils literal notranslate"><span class="pre">dist0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-ot-utils-dist0">Examples using <code class="docutils literal notranslate"><span class="pre">ot.utils.dist0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-ot-utils-proj-simplex">Examples using <code class="docutils literal notranslate"><span class="pre">ot.utils.proj_simplex</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.BaseEstimator"><code class="docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-ot-utils-baseestimator">Examples using <code class="docutils literal notranslate"><span class="pre">ot.utils.BaseEstimator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exceptions">Exceptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ot.utils.UndefinedParameter"><code class="docutils literal notranslate"><span class="pre">UndefinedParameter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">check_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">check_random_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">clean_zeros()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">cost_normalization()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">deprecated</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">dist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">dist0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">dots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">euclidean_distances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">get_coordinate_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">is_all_finite()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">label_normalization()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">laplacian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">list_to_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">parmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">proj_simplex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">projection_sparse_simplex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">tic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">toc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">toq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">unif()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ot.weak.html">ot.weak</a></li>
<li class="toctree-l2"><a class="reference internal" href="../all.html#module-ot">Main <code class="xref py py-mod docutils literal notranslate"><span class="pre">ot</span></code> functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to POT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of conduct</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">POT Python Optimal Transport</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../all.html">API and modules</a></li>
      <li class="breadcrumb-item active">ot.utils</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gen_modules/ot.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ot.utils">
<span id="ot-utils"></span><h1>ot.utils<a class="headerlink" href="#module-ot.utils" title="Link to this heading"></a></h1>
<p>Various useful functions</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ot.utils.check_params">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">check_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#check_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.check_params" title="Link to this definition"></a></dt>
<dd><p>check_params: check whether some parameters are missing</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.check_random_state">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">check_random_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#check_random_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.check_random_state" title="Link to this definition"></a></dt>
<dd><p>Turn <cite>seed</cite> into a np.random.RandomState instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> | </em><em>instance</em><em> of </em><em>RandomState</em>) – If <cite>seed</cite> is None, return the RandomState singleton used by np.random.
If <cite>seed</cite> is an int, return a new RandomState instance seeded with <cite>seed</cite>.
If <cite>seed</cite> is already a RandomState instance, return it.
Otherwise raise ValueError.</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.clean_zeros">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">clean_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#clean_zeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.clean_zeros" title="Link to this definition"></a></dt>
<dd><p>Remove all components with zeros weights in <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.cost_normalization">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">cost_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#cost_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.cost_normalization" title="Link to this definition"></a></dt>
<dd><p>Apply normalization to the loss matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n1</em><em>, </em><em>n2</em><em>)</em>) – The cost matrix to normalize.</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Type of normalization from ‘median’, ‘max’, ‘log’, ‘loglog’. Any
other value do not normalize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>C</strong> – The input cost matrix normalized according to given norm.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (<cite>n1</cite>, <cite>n2</cite>)</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.dist">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sqeuclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.dist" title="Link to this definition"></a></dt>
<dd><p>Compute distance between samples in <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is backend-compatible and will work on arrays
from all compatible backends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n1</em><em>,</em><em>d</em><em>)</em>) – matrix with <cite>n1</cite> samples of size <cite>d</cite></p></li>
<li><p><strong>x2</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n2</em><em>,</em><em>d</em><em>)</em><em>, </em><em>optional</em>) – matrix with <cite>n2</cite> samples of size <cite>d</cite> (if None then <span class="math notranslate nohighlight">\(\mathbf{x_2} = \mathbf{x_1}\)</span>)</p></li>
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><em>callable</em><em>, </em><em>optional</em>) – ‘sqeuclidean’ or ‘euclidean’ on all backends. On numpy the function also
accepts  from the scipy.spatial.distance.cdist function : ‘braycurtis’,
‘canberra’, ‘chebyshev’, ‘cityblock’, ‘correlation’, ‘cosine’, ‘dice’,
‘euclidean’, ‘hamming’, ‘jaccard’, ‘kulczynski1’, ‘mahalanobis’,
‘matching’, ‘minkowski’, ‘rogerstanimoto’, ‘russellrao’, ‘seuclidean’,
‘sokalmichener’, ‘sokalsneath’, ‘sqeuclidean’, ‘wminkowski’, ‘yule’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – p-norm for the Minkowski and the Weighted Minkowski metrics. Default value is 2.</p></li>
<li><p><strong>w</strong> (<em>array-like</em><em>, </em><em>rank 1</em>) – Weights for the weighted metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>M</strong> – distance matrix computed with given metric</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like, shape (<cite>n1</cite>, <cite>n2</cite>)</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.dist0">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">dist0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lin_square'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#dist0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.dist0" title="Link to this definition"></a></dt>
<dd><p>Compute standard cost matrices of size (<cite>n</cite>, <cite>n</cite>) for OT problems</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Size of the cost matrix.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Type of loss matrix chosen from:</p>
<ul>
<li><p>’lin_square’ : linear sampling between 0 and <cite>n-1</cite>, quadratic loss</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>M</strong> – Distance matrix computed with given metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (<cite>n1</cite>, <cite>n2</cite>)</p>
</dd>
</dl>
</dd></dl>

<section id="examples-using-ot-utils-dist0">
<h3>Examples using <code class="docutils literal notranslate"><span class="pre">ot.utils.dist0</span></code><a class="headerlink" href="#examples-using-ot-utils-dist0" title="Link to this heading"></a></h3>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of regularized Wasserstein Barycenter as proposed in [..."><img alt="" src="../_images/sphx_glr_plot_barycenter_1D_thumb.png" />
<p><a class="reference internal" href="../auto_examples/barycenters/plot_barycenter_1D.html#sphx-glr-auto-examples-barycenters-plot-barycenter-1d-py"><span class="std std-ref">1D Wasserstein barycenter demo</span></a></p>
  <div class="sphx-glr-thumbnail-title">1D Wasserstein barycenter demo</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of the debiased Sinkhorn barycenter as proposed in [37..."><img alt="" src="../_images/sphx_glr_plot_debiased_barycenter_thumb.png" />
<p><a class="reference internal" href="../auto_examples/barycenters/plot_debiased_barycenter.html#sphx-glr-auto-examples-barycenters-plot-debiased-barycenter-py"><span class="std std-ref">Debiased Sinkhorn barycenter demo</span></a></p>
  <div class="sphx-glr-thumbnail-title">Debiased Sinkhorn barycenter demo</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of regularized Wasserstein Barycenter as proposed in [..."><img alt="" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_thumb.png" />
<p><a class="reference internal" href="../auto_examples/barycenters/plot_barycenter_lp_vs_entropic.html#sphx-glr-auto-examples-barycenters-plot-barycenter-lp-vs-entropic-py"><span class="std std-ref">1D Wasserstein barycenter: exact LP vs entropic regularization</span></a></p>
  <div class="sphx-glr-thumbnail-title">1D Wasserstein barycenter: exact LP vs entropic regularization</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of regularized Wasserstein Barycenter as proposed in [..."><img alt="" src="../_images/sphx_glr_plot_UOT_barycenter_1D_thumb.png" />
<p><a class="reference internal" href="../auto_examples/unbalanced-partial/plot_UOT_barycenter_1D.html#sphx-glr-auto-examples-unbalanced-partial-plot-uot-barycenter-1d-py"><span class="std std-ref">1D Wasserstein barycenter demo for Unbalanced distributions</span></a></p>
  <div class="sphx-glr-thumbnail-title">1D Wasserstein barycenter demo for Unbalanced distributions</div>
</div></div><div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.dots">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">dots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#dots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.dots" title="Link to this definition"></a></dt>
<dd><p>dots function for multiple matrix multiply</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.euclidean_distances">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">euclidean_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#euclidean_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.euclidean_distances" title="Link to this definition"></a></dt>
<dd><p>Considering the rows of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> (and <span class="math notranslate nohighlight">\(\mathbf{Y} = \mathbf{X}\)</span>) as vectors, compute the
distance matrix between each pair of vectors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is backend-compatible and will work on arrays
from all compatible backends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples_1</em><em>, </em><em>n_features</em><em>)</em>) – </p></li>
<li><p><strong>Y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples_2</em><em>, </em><em>n_features</em><em>)</em>) – </p></li>
<li><p><strong>squared</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Return squared Euclidean distances.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>distances</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like, shape (<cite>n_samples_1</cite>, <cite>n_samples_2</cite>)</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.get_coordinate_circle">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">get_coordinate_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#get_coordinate_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.get_coordinate_circle" title="Link to this definition"></a></dt>
<dd><p>For <span class="math notranslate nohighlight">\(x\in S^1 \subset \mathbb{R}^2\)</span>, returns the coordinates in
turn (in [0,1[).</p>
<div class="math notranslate nohighlight">
\[u = \frac{\pi + \mathrm{atan2}(-x_2,-x_1)}{2\pi}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>, </em><em>2</em><em>)</em>) – Samples on the circle with ambient coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x_t</strong> – Coordinates on [0,1[</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n,)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_coordinate_circle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([0.2, 0.5, 0.8])</span>
</pre></div>
</div>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.is_all_finite">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">is_all_finite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#is_all_finite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.is_all_finite" title="Link to this definition"></a></dt>
<dd><p>Tests element-wise for finiteness in all arguments.</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.kernel">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.kernel" title="Link to this definition"></a></dt>
<dd><p>Compute kernel matrix</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.label_normalization">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">label_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#label_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.label_normalization" title="Link to this definition"></a></dt>
<dd><p>Transform labels to start at a given value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>, </em><em>)</em>) – The vector of labels to be normalized.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Desired value for the smallest label in <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> (default=0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – The input vector of labels normalized according to given start value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like, shape (<cite>n1</cite>, )</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.laplacian">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#laplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.laplacian" title="Link to this definition"></a></dt>
<dd><p>Compute Laplacian matrix</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.list_to_array">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">list_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#list_to_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.list_to_array" title="Link to this definition"></a></dt>
<dd><p>Convert a list if in numpy format</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.parmap">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">parmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprocs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#parmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.parmap" title="Link to this definition"></a></dt>
<dd><p>parallel map for multiprocessing.
The function has been deprecated and only performs a regular map.</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.proj_simplex">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">proj_simplex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#proj_simplex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.proj_simplex" title="Link to this definition"></a></dt>
<dd><p>Compute the closest point (orthogonal projection) on the
generalized <cite>(n-1)</cite>-simplex of a vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> wrt. to the Euclidean
distance, thus solving:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathcal{P}(w) \in \mathop{\arg \min}_\gamma \| \gamma - \mathbf{v} \|_2\\s.t. \ \gamma^T \mathbf{1} = z\\     \gamma \geq 0\end{aligned}\end{align} \]</div>
<p>If <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is a 2d array, compute all the projections wrt. axis 0</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is backend-compatible and will work on arrays
from all compatible backends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>{array-like}</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>, </em><em>d</em><em>)</em>) – </p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – ‘size’ of the simplex (each vectors sum to z, 1 by default)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>h</strong> – Array of projections on the simplex</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (<cite>n</cite>, <cite>d</cite>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="examples-using-ot-utils-proj-simplex">
<h3>Examples using <code class="docutils literal notranslate"><span class="pre">ot.utils.proj_simplex</span></code><a class="headerlink" href="#examples-using-ot-utils-proj-simplex" title="Link to this heading"></a></h3>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="In this example we estimate mixing parameters from distributions that minimize the Wasserstein ..."><img alt="" src="../_images/sphx_glr_plot_unmix_optim_torch_thumb.png" />
<p><a class="reference internal" href="../auto_examples/backends/plot_unmix_optim_torch.html#sphx-glr-auto-examples-backends-plot-unmix-optim-torch-py"><span class="std std-ref">Wasserstein unmixing with PyTorch</span></a></p>
  <div class="sphx-glr-thumbnail-title">Wasserstein unmixing with PyTorch</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this small example, we consider the following minimization problem:"><img alt="" src="../_images/sphx_glr_plot_wass1d_torch_thumb.png" />
<p><a class="reference internal" href="../auto_examples/backends/plot_wass1d_torch.html#sphx-glr-auto-examples-backends-plot-wass1d-torch-py"><span class="std std-ref">Wasserstein 1D (flow and barycenter) with PyTorch</span></a></p>
  <div class="sphx-glr-thumbnail-title">Wasserstein 1D (flow and barycenter) with PyTorch</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example, we use the pytorch backend to optimize the Gromov-Wasserstein (GW) loss betwee..."><img alt="" src="../_images/sphx_glr_plot_optim_gromov_pytorch_thumb.png" />
<p><a class="reference internal" href="../auto_examples/backends/plot_optim_gromov_pytorch.html#sphx-glr-auto-examples-backends-plot-optim-gromov-pytorch-py"><span class="std std-ref">Optimizing the Gromov-Wasserstein distance with PyTorch</span></a></p>
  <div class="sphx-glr-thumbnail-title">Optimizing the Gromov-Wasserstein distance with PyTorch</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example, we illustrate how to estimate the sample marginal distribution which minimizes..."><img alt="" src="../_images/sphx_glr_plot_learning_weights_with_COOT_thumb.png" />
<p><a class="reference internal" href="../auto_examples/others/plot_learning_weights_with_COOT.html#sphx-glr-auto-examples-others-plot-learning-weights-with-coot-py"><span class="std std-ref">Learning sample marginal distribution with CO-Optimal Transport</span></a></p>
  <div class="sphx-glr-thumbnail-title">Learning sample marginal distribution with CO-Optimal Transport</div>
</div></div><div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.projection_sparse_simplex">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">projection_sparse_simplex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#projection_sparse_simplex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.projection_sparse_simplex" title="Link to this definition"></a></dt>
<dd><p>Projection of <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> onto the simplex with cardinality constraint (maximum number of non-zero elements) and then scaled by <cite>z</cite>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}P\left(\mathbf{V}, max_nz, z\right) = \mathop{\arg \min}_{\substack{\mathbf{y} &gt;= 0 \\ \sum_i \mathbf{y}_i = z} \\ ||p||_0 \le \text{max_nz}} \quad \|\mathbf{y} - \mathbf{V}\|^2\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>1-dim</em><em> or </em><em>2-dim ndarray</em>) – </p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> or </em><em>array</em>) – If array, len(z) must be compatible with <span class="math notranslate nohighlight">\(\mathbf{V}\)</span></p></li>
<li><p><strong>axis</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – <ul>
<li><p>axis=None: project <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> by <span class="math notranslate nohighlight">\(P(\mathbf{V}.\mathrm{ravel}(), max_nz, z)\)</span></p></li>
<li><p>axis=1: project each <span class="math notranslate nohighlight">\(\mathbf{V}_i\)</span> by <span class="math notranslate nohighlight">\(P(\mathbf{V}_i, max_nz, z_i)\)</span></p></li>
<li><p>axis=0: project each <span class="math notranslate nohighlight">\(\mathbf{V}_{:, j}\)</span> by <span class="math notranslate nohighlight">\(P(\mathbf{V}_{:, j}, max_nz, z_j)\)</span></p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>projection</strong> (ndarray, shape <span class="math notranslate nohighlight">\(\mathbf{V}\)</span>.shape)</p></li>
<li><p><em>References</em> – Sparse projections onto the simplex
Anastasios Kyrillidis, Stephen Becker, Volkan Cevher and, Christoph Koch
ICML 2013
<a class="reference external" href="https://arxiv.org/abs/1206.1529">https://arxiv.org/abs/1206.1529</a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.tic">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">tic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#tic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.tic" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Matlab tic() function</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.toc">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Elapsed</span> <span class="pre">time</span> <span class="pre">:</span> <span class="pre">{}</span> <span class="pre">s'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#toc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.toc" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Matlab toc() function</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.toq">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">toq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#toq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.toq" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Julia toc() function</p>
</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py function">
<dt class="sig sig-object py" id="ot.utils.unif">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">unif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#unif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.unif" title="Link to this definition"></a></dt>
<dd><p>Return a uniform histogram of length <cite>n</cite> (simplex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of bins in the histogram</p></li>
<li><p><strong>type_as</strong> (<em>array_like</em>) – array of the same type of the expected output (numpy/pytorch/jax)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>h</strong> – histogram of length <cite>n</cite> such that <span class="math notranslate nohighlight">\(\forall i, \mathbf{h}_i = \frac{1}{n}\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like (<cite>n</cite>,)</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div></section>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ot.utils.BaseEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">BaseEstimator</span></span><a class="reference internal" href="../_modules/ot/utils.html#BaseEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.BaseEstimator" title="Link to this definition"></a></dt>
<dd><p>Base class for most objects in POT</p>
<p>Code adapted from sklearn BaseEstimator class</p>
<p class="rubric">Notes</p>
<p>All estimators should specify all the parameters that can be set
at the class level in their <code class="docutils literal notranslate"><span class="pre">__init__</span></code> as explicit keyword
arguments (no <code class="docutils literal notranslate"><span class="pre">*args</span></code> or <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="ot.utils.BaseEstimator.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#BaseEstimator.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.BaseEstimator.get_params" title="Link to this definition"></a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mapping of string to any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ot.utils.BaseEstimator.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#BaseEstimator.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.BaseEstimator.set_params" title="Link to this definition"></a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="examples-using-ot-utils-baseestimator">
<h3>Examples using <code class="docutils literal notranslate"><span class="pre">ot.utils.BaseEstimator</span></code><a class="headerlink" href="#examples-using-ot-utils-baseestimator" title="Link to this heading"></a></h3>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="This example introduces a domain adaptation in a 2D setting and OTDA approach with Laplacian re..."><img alt="" src="../_images/sphx_glr_plot_otda_laplacian_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_laplacian.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-laplacian-py"><span class="std std-ref">OT with Laplacian regularization for domain adaptation</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT with Laplacian regularization for domain adaptation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example presents a way of transferring colors between two images with Optimal Transport as..."><img alt="" src="../_images/sphx_glr_plot_otda_color_images_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_color_images.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-color-images-py"><span class="std std-ref">OT for image color adaptation</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT for image color adaptation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example presents how to use MappingTransport to estimate at the same time both the couplin..."><img alt="" src="../_images/sphx_glr_plot_otda_mapping_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_mapping.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-mapping-py"><span class="std std-ref">OT mapping estimation for domain adaptation</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT mapping estimation for domain adaptation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="OT for domain adaptation with image color adaptation [6] with mapping estimation [8]."><img alt="" src="../_images/sphx_glr_plot_otda_mapping_colors_images_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_mapping_colors_images.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-mapping-colors-images-py"><span class="std std-ref">OT for image color adaptation with mapping estimation</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT for image color adaptation with mapping estimation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example introduces a semi supervised domain adaptation in a 2D setting. It explicits the p..."><img alt="" src="../_images/sphx_glr_plot_otda_semi_supervised_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_semi_supervised.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-semi-supervised-py"><span class="std std-ref">OTDA unsupervised vs semi-supervised setting</span></a></p>
  <div class="sphx-glr-thumbnail-title">OTDA unsupervised vs semi-supervised setting</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Linear OT mapping estimation"><img alt="" src="../_images/sphx_glr_plot_otda_linear_mapping_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_linear_mapping.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-linear-mapping-py"><span class="std std-ref">Linear OT mapping estimation</span></a></p>
  <div class="sphx-glr-thumbnail-title">Linear OT mapping estimation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example introduces a domain adaptation in a 2D setting and the 4 OTDA approaches currently..."><img alt="" src="../_images/sphx_glr_plot_otda_classes_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_classes.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-classes-py"><span class="std std-ref">OT for domain adaptation</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT for domain adaptation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example introduces a domain adaptation in a 2D setting. It explicits the problem of domain..."><img alt="" src="../_images/sphx_glr_plot_otda_d2_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_d2.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-d2-py"><span class="std std-ref">OT for domain adaptation on empirical distributions</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT for domain adaptation on empirical distributions</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example introduces a target shift problem with two 2D source and 1 target domain."><img alt="" src="../_images/sphx_glr_plot_otda_jcpot_thumb.png" />
<p><a class="reference internal" href="../auto_examples/domain-adaptation/plot_otda_jcpot.html#sphx-glr-auto-examples-domain-adaptation-plot-otda-jcpot-py"><span class="std std-ref">OT for multi-source target shift</span></a></p>
  <div class="sphx-glr-thumbnail-title">OT for multi-source target shift</div>
</div></div><div class="sphx-glr-clear"></div><dl class="py class">
<dt class="sig sig-object py" id="ot.utils.OTResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">OTResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potentials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_plan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy_plan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#OTResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.OTResult" title="Link to this definition"></a></dt>
<dd><dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.a_to_b">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a_to_b</span></span><a class="headerlink" href="#ot.utils.OTResult.a_to_b" title="Link to this definition"></a></dt>
<dd><p>Displacement vectors from the first to the second measure.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.b_to_a">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">b_to_a</span></span><a class="headerlink" href="#ot.utils.OTResult.b_to_a" title="Link to this definition"></a></dt>
<dd><p>Displacement vectors from the second to the first measure.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#ot.utils.OTResult.citation" title="Link to this definition"></a></dt>
<dd><p>Appropriate citation(s) for this result, in plain text and BibTex formats.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.lazy_plan">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lazy_plan</span></span><a class="headerlink" href="#ot.utils.OTResult.lazy_plan" title="Link to this definition"></a></dt>
<dd><p>Transport plan, encoded as a symbolic KeOps LazyTensor.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.marginal_a">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">marginal_a</span></span><a class="headerlink" href="#ot.utils.OTResult.marginal_a" title="Link to this definition"></a></dt>
<dd><p>First marginal of the transport plan, with the same shape as “a”.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.marginal_b">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">marginal_b</span></span><a class="headerlink" href="#ot.utils.OTResult.marginal_b" title="Link to this definition"></a></dt>
<dd><p>Second marginal of the transport plan, with the same shape as “b”.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.marginals">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">marginals</span></span><a class="headerlink" href="#ot.utils.OTResult.marginals" title="Link to this definition"></a></dt>
<dd><p>should be very close to “a” and “b”
for balanced OT.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Marginals of the transport plan</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.plan">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plan</span></span><a class="headerlink" href="#ot.utils.OTResult.plan" title="Link to this definition"></a></dt>
<dd><p>Transport plan, encoded as a dense array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.potential_a">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">potential_a</span></span><a class="headerlink" href="#ot.utils.OTResult.potential_a" title="Link to this definition"></a></dt>
<dd><p>First dual potential, associated to the “source” measure “a”.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.potential_b">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">potential_b</span></span><a class="headerlink" href="#ot.utils.OTResult.potential_b" title="Link to this definition"></a></dt>
<dd><p>Second dual potential, associated to the “target” measure “b”.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.potentials">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">potentials</span></span><a class="headerlink" href="#ot.utils.OTResult.potentials" title="Link to this definition"></a></dt>
<dd><p>Dual potentials, i.e. Lagrange multipliers for the marginal constraints.</p>
<p>This pair of arrays has the same shape, numerical type
and properties as the input weights “a” and “b”.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.sparse_plan">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparse_plan</span></span><a class="headerlink" href="#ot.utils.OTResult.sparse_plan" title="Link to this definition"></a></dt>
<dd><p>Transport plan, encoded as a sparse array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.status">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">status</span></span><a class="headerlink" href="#ot.utils.OTResult.status" title="Link to this definition"></a></dt>
<dd><p>Optimization status of the solver.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#ot.utils.OTResult.value" title="Link to this definition"></a></dt>
<dd><p>Full transport cost, including possible regularization terms.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ot.utils.OTResult.value_linear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value_linear</span></span><a class="headerlink" href="#ot.utils.OTResult.value_linear" title="Link to this definition"></a></dt>
<dd><p>The “minimal” transport cost, i.e. the product between the transport plan and the cost.</p>
</dd></dl>

</dd></dl>

<div class="sphx-glr-clear"></div><dl class="py class">
<dt class="sig sig-object py" id="ot.utils.deprecated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">deprecated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#deprecated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.deprecated" title="Link to this definition"></a></dt>
<dd><p>Decorator to mark a function or class as deprecated.</p>
<p>deprecated class from scikit-learn package
<a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/deprecation.py">https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/deprecation.py</a>
Issue a warning when the function is called/the class is instantiated and
adds a warning to the docstring.
The optional extra argument will be appended to the deprecation message
and the docstring.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To use this with the default value for extra, use empty parentheses:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ot.deprecation</span> <span class="kn">import</span> <span class="n">deprecated</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@deprecated</span><span class="p">()</span>  
<span class="gp">... </span><span class="k">def</span> <span class="nf">some_function</span><span class="p">():</span> <span class="k">pass</span>  
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – To be added to the deprecation messages.</p>
</dd>
</dl>
</dd></dl>

<div class="sphx-glr-clear"></div></section>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ot.utils.UndefinedParameter" title="ot.utils.UndefinedParameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UndefinedParameter</span></code></a></p></td>
<td><p>Aim at raising an Exception when a undefined parameter is called</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">BaseEstimator</span></span><a class="reference internal" href="../_modules/ot/utils.html#BaseEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Base class for most objects in POT</p>
<p>Code adapted from sklearn BaseEstimator class</p>
<p class="rubric">Notes</p>
<p>All estimators should specify all the parameters that can be set
at the class level in their <code class="docutils literal notranslate"><span class="pre">__init__</span></code> as explicit keyword
arguments (no <code class="docutils literal notranslate"><span class="pre">*args</span></code> or <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#BaseEstimator.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mapping of string to any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#BaseEstimator.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="ot.utils.UndefinedParameter">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">UndefinedParameter</span></span><a class="reference internal" href="../_modules/ot/utils.html#UndefinedParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ot.utils.UndefinedParameter" title="Link to this definition"></a></dt>
<dd><p>Aim at raising an Exception when a undefined parameter is called</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id3">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">check_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#check_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>check_params: check whether some parameters are missing</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id4">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">check_random_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#check_random_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Turn <cite>seed</cite> into a np.random.RandomState instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> | </em><em>instance</em><em> of </em><em>RandomState</em>) – If <cite>seed</cite> is None, return the RandomState singleton used by np.random.
If <cite>seed</cite> is an int, return a new RandomState instance seeded with <cite>seed</cite>.
If <cite>seed</cite> is already a RandomState instance, return it.
Otherwise raise ValueError.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id5">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">clean_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#clean_zeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Remove all components with zeros weights in <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id6">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">cost_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#cost_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Apply normalization to the loss matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n1</em><em>, </em><em>n2</em><em>)</em>) – The cost matrix to normalize.</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Type of normalization from ‘median’, ‘max’, ‘log’, ‘loglog’. Any
other value do not normalize.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>C</strong> – The input cost matrix normalized according to given norm.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (<cite>n1</cite>, <cite>n2</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id7">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">deprecated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#deprecated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Decorator to mark a function or class as deprecated.</p>
<p>deprecated class from scikit-learn package
<a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/deprecation.py">https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/utils/deprecation.py</a>
Issue a warning when the function is called/the class is instantiated and
adds a warning to the docstring.
The optional extra argument will be appended to the deprecation message
and the docstring.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To use this with the default value for extra, use empty parentheses:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ot.deprecation</span> <span class="kn">import</span> <span class="n">deprecated</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@deprecated</span><span class="p">()</span>  
<span class="gp">... </span><span class="k">def</span> <span class="nf">some_function</span><span class="p">():</span> <span class="k">pass</span>  
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – To be added to the deprecation messages.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id8">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sqeuclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Compute distance between samples in <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is backend-compatible and will work on arrays
from all compatible backends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n1</em><em>,</em><em>d</em><em>)</em>) – matrix with <cite>n1</cite> samples of size <cite>d</cite></p></li>
<li><p><strong>x2</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n2</em><em>,</em><em>d</em><em>)</em><em>, </em><em>optional</em>) – matrix with <cite>n2</cite> samples of size <cite>d</cite> (if None then <span class="math notranslate nohighlight">\(\mathbf{x_2} = \mathbf{x_1}\)</span>)</p></li>
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> | </em><em>callable</em><em>, </em><em>optional</em>) – ‘sqeuclidean’ or ‘euclidean’ on all backends. On numpy the function also
accepts  from the scipy.spatial.distance.cdist function : ‘braycurtis’,
‘canberra’, ‘chebyshev’, ‘cityblock’, ‘correlation’, ‘cosine’, ‘dice’,
‘euclidean’, ‘hamming’, ‘jaccard’, ‘kulczynski1’, ‘mahalanobis’,
‘matching’, ‘minkowski’, ‘rogerstanimoto’, ‘russellrao’, ‘seuclidean’,
‘sokalmichener’, ‘sokalsneath’, ‘sqeuclidean’, ‘wminkowski’, ‘yule’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – p-norm for the Minkowski and the Weighted Minkowski metrics. Default value is 2.</p></li>
<li><p><strong>w</strong> (<em>array-like</em><em>, </em><em>rank 1</em>) – Weights for the weighted metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>M</strong> – distance matrix computed with given metric</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like, shape (<cite>n1</cite>, <cite>n2</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id9">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">dist0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lin_square'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#dist0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Compute standard cost matrices of size (<cite>n</cite>, <cite>n</cite>) for OT problems</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Size of the cost matrix.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Type of loss matrix chosen from:</p>
<ul>
<li><p>’lin_square’ : linear sampling between 0 and <cite>n-1</cite>, quadratic loss</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>M</strong> – Distance matrix computed with given metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (<cite>n1</cite>, <cite>n2</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id10">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">dots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#dots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>dots function for multiple matrix multiply</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id11">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">euclidean_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#euclidean_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Considering the rows of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> (and <span class="math notranslate nohighlight">\(\mathbf{Y} = \mathbf{X}\)</span>) as vectors, compute the
distance matrix between each pair of vectors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is backend-compatible and will work on arrays
from all compatible backends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples_1</em><em>, </em><em>n_features</em><em>)</em>) – </p></li>
<li><p><strong>Y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples_2</em><em>, </em><em>n_features</em><em>)</em>) – </p></li>
<li><p><strong>squared</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Return squared Euclidean distances.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>distances</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like, shape (<cite>n_samples_1</cite>, <cite>n_samples_2</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id12">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">get_coordinate_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#get_coordinate_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>For <span class="math notranslate nohighlight">\(x\in S^1 \subset \mathbb{R}^2\)</span>, returns the coordinates in
turn (in [0,1[).</p>
<div class="math notranslate nohighlight">
\[u = \frac{\pi + \mathrm{atan2}(-x_2,-x_1)}{2\pi}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>, </em><em>2</em><em>)</em>) – Samples on the circle with ambient coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x_t</strong> – Coordinates on [0,1[</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n,)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_coordinate_circle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([0.2, 0.5, 0.8])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id13">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">is_all_finite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#is_all_finite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd><p>Tests element-wise for finiteness in all arguments.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id14">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd><p>Compute kernel matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id15">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">label_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#label_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Transform labels to start at a given value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>, </em><em>)</em>) – The vector of labels to be normalized.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Desired value for the smallest label in <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> (default=0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – The input vector of labels normalized according to given start value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like, shape (<cite>n1</cite>, )</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id16">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#laplacian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Compute Laplacian matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id17">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">list_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#list_to_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Convert a list if in numpy format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id18">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">parmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprocs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#parmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>parallel map for multiprocessing.
The function has been deprecated and only performs a regular map.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id19">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">proj_simplex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#proj_simplex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd><p>Compute the closest point (orthogonal projection) on the
generalized <cite>(n-1)</cite>-simplex of a vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> wrt. to the Euclidean
distance, thus solving:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathcal{P}(w) \in \mathop{\arg \min}_\gamma \| \gamma - \mathbf{v} \|_2\\s.t. \ \gamma^T \mathbf{1} = z\\     \gamma \geq 0\end{aligned}\end{align} \]</div>
<p>If <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is a 2d array, compute all the projections wrt. axis 0</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is backend-compatible and will work on arrays
from all compatible backends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>{array-like}</em><em>, </em><em>shape</em><em> (</em><em>n</em><em>, </em><em>d</em><em>)</em>) – </p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – ‘size’ of the simplex (each vectors sum to z, 1 by default)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>h</strong> – Array of projections on the simplex</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (<cite>n</cite>, <cite>d</cite>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id20">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">projection_sparse_simplex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#projection_sparse_simplex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Projection of <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> onto the simplex with cardinality constraint (maximum number of non-zero elements) and then scaled by <cite>z</cite>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}P\left(\mathbf{V}, max_nz, z\right) = \mathop{\arg \min}_{\substack{\mathbf{y} &gt;= 0 \\ \sum_i \mathbf{y}_i = z} \\ ||p||_0 \le \text{max_nz}} \quad \|\mathbf{y} - \mathbf{V}\|^2\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>1-dim</em><em> or </em><em>2-dim ndarray</em>) – </p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> or </em><em>array</em>) – If array, len(z) must be compatible with <span class="math notranslate nohighlight">\(\mathbf{V}\)</span></p></li>
<li><p><strong>axis</strong> (<em>None</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – <ul>
<li><p>axis=None: project <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> by <span class="math notranslate nohighlight">\(P(\mathbf{V}.\mathrm{ravel}(), max_nz, z)\)</span></p></li>
<li><p>axis=1: project each <span class="math notranslate nohighlight">\(\mathbf{V}_i\)</span> by <span class="math notranslate nohighlight">\(P(\mathbf{V}_i, max_nz, z_i)\)</span></p></li>
<li><p>axis=0: project each <span class="math notranslate nohighlight">\(\mathbf{V}_{:, j}\)</span> by <span class="math notranslate nohighlight">\(P(\mathbf{V}_{:, j}, max_nz, z_j)\)</span></p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>projection</strong> (ndarray, shape <span class="math notranslate nohighlight">\(\mathbf{V}\)</span>.shape)</p></li>
<li><p><em>References</em> – Sparse projections onto the simplex
Anastasios Kyrillidis, Stephen Becker, Volkan Cevher and, Christoph Koch
ICML 2013
<a class="reference external" href="https://arxiv.org/abs/1206.1529">https://arxiv.org/abs/1206.1529</a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id21">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">tic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#tic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Matlab tic() function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id22">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Elapsed</span> <span class="pre">time</span> <span class="pre">:</span> <span class="pre">{}</span> <span class="pre">s'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#toc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Matlab toc() function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id23">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">toq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#toq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Julia toc() function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id24">
<span class="sig-prename descclassname"><span class="pre">ot.utils.</span></span><span class="sig-name descname"><span class="pre">unif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ot/utils.html#unif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd><p>Return a uniform histogram of length <cite>n</cite> (simplex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of bins in the histogram</p></li>
<li><p><strong>type_as</strong> (<em>array_like</em>) – array of the same type of the expected output (numpy/pytorch/jax)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>h</strong> – histogram of length <cite>n</cite> such that <span class="math notranslate nohighlight">\(\forall i, \mathbf{h}_i = \frac{1}{n}\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like (<cite>n</cite>,)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ot.unbalanced.html" class="btn btn-neutral float-left" title="ot.unbalanced" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ot.weak.html" class="btn btn-neutral float-right" title="ot.weak" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2021, Rémi Flamary, Nicolas Courty.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note"
aria-label="versions">
  <!--  add shift_up to the class for force viewing ,
  data-toggle="rst-current-version" -->
    <span class="rst-current-version"  style="margin-bottom:1mm;">
      <span class="fa fa-book"> Python Optimal Transport</span>
      <hr  style="margin-bottom:1.5mm;margin-top:5mm;">
     <!--  versions
      <span class="fa fa-caret-down"></span>-->
      <span class="rst-current-version" style="display: inline-block;padding:
      0px;color:#fcfcfcab;float:left;font-size: 100%;">
        Versions: 
        <a href="https://pythonot.github.io/" 
        style="padding: 3px;color:#fcfcfc;font-size: 100%;">Release</a>
        <a href="https://pythonot.github.io/master" 
        style="padding: 3px;color:#fcfcfc;font-size: 100%;">Development</a>
        <a href="https://github.com/PythonOT/POT"
        style="padding: 3px;color:#fcfcfc;font-size: 100%;">Code</a>

      </span>

     
    </span>
  
     <!--
    <div class="rst-other-versions">

      

<div class="injected">

    
  <dl>
    <dt>Versions</dt>

    <dd><a href="https://pythonot.github.io/">Release</a></dd>
    
    <dd><a href="https://pythonot.github.io/master">Development</a></dd>
   
    

    <dt><a href="https://github.com/PythonOT/POT">Code on Github</a></dt>       

    
  </dl>
  <hr>

</div> 
</div>-->
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>