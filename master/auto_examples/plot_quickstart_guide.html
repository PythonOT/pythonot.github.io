

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quickstart Guide &mdash; POT Python Optimal Transport 0.9.6dev0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=6e3d2238"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples gallery" href="index.html" />
    <link rel="prev" title="POT: Python Optimal Transport" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            POT Python Optimal Transport
              <img src="../_static/logo_dark.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">POT: Python Optimal Transport</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#d-data-example">2D data example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solving-exact-optimal-transport">Solving exact Optimal Transport</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solve-the-optimal-transport-problem-between-the-samples">Solve the Optimal Transport problem between the samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimal-transport-problem-with-a-custom-cost-matrix">Optimal Transport problem with a custom cost matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sinkhorn-and-regularized-ot">Sinkhorn and Regularized OT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#entropic-ot-with-sinkhorn-algorithm">Entropic OT with Sinkhorn algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quadratic-regularized-ot">Quadratic Regularized OT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solve-the-regularized-ot-problem-with-user-defined-regularization">Solve the Regularized OT problem with user-defined regularization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#unbalanced-and-partial-ot">Unbalanced and Partial OT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unbalanced-optimal-transport">Unbalanced Optimal Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="#partial-optimal-transport">Partial Optimal Transport</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gromov-wasserstein-and-fused-gromov-wasserstein">Gromov-Wasserstein and Fused Gromov-Wasserstein</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gromov-wasserstein-and-entropic-gw">Gromov-Wasserstein and Entropic GW</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fused-gromov-wasserstein">Fused Gromov-Wasserstein</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#large-scale-ot">Large scale OT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#large-scale-sinkhorn">Large scale Sinkhorn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#factored-and-low-rank-ot">Factored and Low rank OT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gaussian-ot-with-bures-wasserstein">Gaussian OT with Bures-Wasserstein</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-all-ot-plans">Comparing all OT plans</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Examples gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../all.html">API and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to POT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of conduct</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">POT Python Optimal Transport</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quickstart Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/plot_quickstart_guide.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-quickstart-guide-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="quickstart-guide">
<span id="sphx-glr-auto-examples-plot-quickstart-guide-py"></span><h1>Quickstart Guide<a class="headerlink" href="#quickstart-guide" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Example added in release: 0.9.6</p>
</div>
<p>Quickstart guide to the POT toolbox.</p>
<p>For better readability, only the use of POT is provided and the plotting code
with matplotlib is hidden (but is available in the source file of the example).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We use here the unified API of POT which is more flexible and allows to solve a wider range of problems with just a few functions. The classical API is still available (the unified API
one is a convenient wrapper around the classical one) and we provide pointers to the
classical API when needed.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Remi Flamary</span>
<span class="c1">#</span>
<span class="c1"># License: MIT License</span>
<span class="c1"># sphinx_gallery_thumbnail_number = 4</span>

<span class="c1"># Import necessary libraries</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ot</span>
</pre></div>
</div>
<section id="d-data-example">
<h2>2D data example<a class="headerlink" href="#d-data-example" title="Link to this heading"></a></h2>
<p>We first generate two sets of samples in 2D that 25 and 50
samples respectively located on circles. The weights of the samples are
uniform.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Problem size</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n1</span></a> <span class="o">=</span> <span class="mi">25</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n2</span></a> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Generate random data</span>
<a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a> <span class="o">=</span> <a href="../all.html#ot.unif" title="ot.unif" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n1</span></a><span class="p">)</span>  <span class="c1"># weights of points in the source domain</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a> <span class="o">=</span> <a href="../all.html#ot.unif" title="ot.unif" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">unif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n2</span></a><span class="p">)</span>  <span class="c1"># weights of points in the target domain</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randn.html#numpy.random.randn" title="numpy.random.randn" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n1</span></a><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a> <span class="o">/=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="numpy.sum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randn.html#numpy.random.randn" title="numpy.random.randn" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n2</span></a><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a> <span class="o">/=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="numpy.sum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span>

<span class="c1"># Compute the cost matrix</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a> <span class="o">=</span> <a href="../all.html#ot.dist" title="ot.dist" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">dist</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">)</span>  <span class="c1"># Squared Euclidean cost matrix by default</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_quickstart_guide_001.png" srcset="../_images/sphx_glr_plot_quickstart_guide_001.png" alt="Source and target distributions" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_quickstart_guide_002.png" srcset="../_images/sphx_glr_plot_quickstart_guide_002.png" alt="Cost matrix C" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Cost matrix C&#39;)
</pre></div>
</div>
</section>
<section id="solving-exact-optimal-transport">
<h2>Solving exact Optimal Transport<a class="headerlink" href="#solving-exact-optimal-transport" title="Link to this heading"></a></h2>
<section id="solve-the-optimal-transport-problem-between-the-samples">
<h3>Solve the Optimal Transport problem between the samples<a class="headerlink" href="#solve-the-optimal-transport-problem-between-the-samples" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../all.html#ot.solve_sample" title="ot.solve_sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.solve_sample()</span></code></a> function can be used to solve the Optimal Transport problem
between two sets of samples. The function takes as its two first arguments the
positions of the source and target samples, and returns an <a class="reference internal" href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ot.utils.OTResult</span></code></a> object.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the OT problem</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">)</span>

<span class="c1"># get the OT plan</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id37" title="ot.utils.OTResult.plan" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">plan</span></a>

<span class="c1"># get the OT loss</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id43" title="ot.utils.OTResult.value" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value</span></a>

<span class="c1"># get the dual potentials</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">beta</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id40" title="ot.utils.OTResult.potentials" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">potentials</span></a>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OT loss = </span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a><span class="si">:</span><span class="s2">1.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_quickstart_guide_003.png" srcset="../_images/sphx_glr_plot_quickstart_guide_003.png" alt="OT plan P loss=5.292, Dual potentials" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_quickstart_guide_004.png" srcset="../_images/sphx_glr_plot_quickstart_guide_004.png" alt="OT plan" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>OT loss = 5.292
</pre></div>
</div>
<p>The figure above shows the Optimal Transport plan between the source and target
samples. The color intensity represents the amount of mass transported
between the samples. The dual potentials of the OT problem are also shown.</p>
<p>The weights of the samples in the source and target domains <code class="code docutils literal notranslate"><span class="pre">a</span></code> and
<code class="code docutils literal notranslate"><span class="pre">b</span></code> are given to the function. If not provided, the weights are assumed
to be uniform See <a class="reference internal" href="../all.html#ot.solve_sample" title="ot.solve_sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.solve_sample()</span></code></a> for more details.</p>
<p>The <a class="reference internal" href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ot.utils.OTResult</span></code></a> object contains the following attributes:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">value</span></code>: the value of the OT problem</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">plan</span></code>: the OT matrix</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">potentials</span></code>: Dual potentials of the OT problem</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">log</span></code>: log dictionary of the solver</p></li>
</ul>
<p>The OT matrix <span class="math notranslate nohighlight">\(P\)</span> is a matrix of size <code class="code docutils literal notranslate"><span class="pre">(n1,</span> <span class="pre">n2)</span></code> where
<code class="code docutils literal notranslate"><span class="pre">P[i,j]</span></code> is the amount of mass
transported from <code class="code docutils literal notranslate"><span class="pre">x1[i]</span></code> to <code class="code docutils literal notranslate"><span class="pre">x2[j]</span></code>.</p>
<p>The OT loss is the sum of the element-wise product of the OT matrix and the
cost matrix taken by default as the Squared Euclidean distance.</p>
</section>
<section id="optimal-transport-problem-with-a-custom-cost-matrix">
<h3>Optimal Transport problem with a custom cost matrix<a class="headerlink" href="#optimal-transport-problem-with-a-custom-cost-matrix" title="Link to this heading"></a></h3>
<p>The cost matrix can be customized by passing it to the more general
<a class="reference internal" href="../all.html#ot.solve" title="ot.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.solve()</span></code></a> function. The cost matrix should be a matrix of size
<code class="code docutils literal notranslate"><span class="pre">(n1,</span> <span class="pre">n2)</span></code> where <code class="code docutils literal notranslate"><span class="pre">C[i,j]</span></code> is the cost of transporting mass from
<code class="code docutils literal notranslate"><span class="pre">x1[i]</span></code> to <code class="code docutils literal notranslate"><span class="pre">x2[j]</span></code>.</p>
<p>In this example, we use the Citybloc distance as the cost matrix.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the cost matrix</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C_city</span></a> <span class="o">=</span> <a href="../all.html#ot.dist" title="ot.dist" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">dist</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;cityblock&quot;</span><span class="p">)</span>

<span class="c1"># Solve the OT problem with the custom cost matrix</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol</span></a> <span class="o">=</span> <a href="../all.html#ot.solve" title="ot.solve" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C_city</span></a><span class="p">)</span>
<span class="c1"># the parameters a and b are not provided so uniform weights are assumed</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_city</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id37" title="ot.utils.OTResult.plan" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">plan</span></a>
<span class="c1"># on empirical data the same can be done with ot.solve_sample :</span>
<span class="c1"># sol = ot.solve_sample(x1, x2, metric=&#39;cityblock&#39;)</span>

<span class="c1"># Compute the OT loss (equivalent to ot.solve(C).value)</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss_city</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id43" title="ot.utils.OTResult.value" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value</span></a>  <span class="c1"># same as np.sum(P_city * C)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_quickstart_guide_005.png" srcset="../_images/sphx_glr_plot_quickstart_guide_005.png" alt="OT plan (Citybloc) loss=2.925" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_quickstart_guide_006.png" srcset="../_images/sphx_glr_plot_quickstart_guide_006.png" alt="OT plan (Citybloc)" class = "sphx-glr-multi-img"/></li>
</ul>
<p>Note that we show here how to solve the OT problem with a custom cost matrix
with the more general <a class="reference internal" href="../all.html#ot.solve" title="ot.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.solve()</span></code></a> function.
But the same can be done with the <a class="reference internal" href="../all.html#ot.solve_sample" title="ot.solve_sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.solve_sample()</span></code></a> function by passing
<code class="code docutils literal notranslate"><span class="pre">metric='cityblock'</span></code> as argument.</p>
<p>The cost matrix can be computed with the <a class="reference internal" href="../all.html#ot.dist" title="ot.dist"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.dist()</span></code></a> function which
computes the pairwise distance between two sets of samples or can be provided
directly as a matrix by the user when no samples are available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The examples above use the unified API of POT. The classic API is still available
and and OT plan and loss can be computed with the <a class="reference internal" href="../all.html#ot.emd" title="ot.emd"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.emd()</span></code></a>  and
the <a class="reference internal" href="../all.html#ot.emd2" title="ot.emd2"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.emd2()</span></code></a> functions as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P</span></a> <span class="o">=</span> <a href="../all.html#ot.emd" title="ot.emd" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">emd</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a> <span class="o">=</span> <a href="../all.html#ot.emd2" title="ot.emd2" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">emd2</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">)</span> <span class="c1"># same as np.sum(P*C) but differentiable wrt a/b</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="sinkhorn-and-regularized-ot">
<h2>Sinkhorn and Regularized OT<a class="headerlink" href="#sinkhorn-and-regularized-ot" title="Link to this heading"></a></h2>
<section id="entropic-ot-with-sinkhorn-algorithm">
<h3>Entropic OT with Sinkhorn algorithm<a class="headerlink" href="#entropic-ot-with-sinkhorn-algorithm" title="Link to this heading"></a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the Sinkhorn problem (just add reg parameter value)</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>

<span class="c1"># get the OT plan and loss</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_sink</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id37" title="ot.utils.OTResult.plan" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">plan</span></a>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_sink</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id43" title="ot.utils.OTResult.value" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value</span></a>  <span class="c1"># objective value of the Sinkhorn problem (incl. entropy)</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_sink_linear</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id44" title="ot.utils.OTResult.value_linear" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value_linear</span></a>  <span class="c1"># np.sum(P_sink * C) linear part of loss</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_quickstart_guide_007.png" srcset="../_images/sphx_glr_plot_quickstart_guide_007.png" alt="Sinkhorn OT plan loss=5.566" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_quickstart_guide_008.png" srcset="../_images/sphx_glr_plot_quickstart_guide_008.png" alt="Sinkhorn OT plan" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/circleci/project/ot/bregman/_sinkhorn.py:903: UserWarning: Sinkhorn did not converge. You might want to increase the number of iterations `numItermax` or the regularization parameter `reg`.
  warnings.warn(
</pre></div>
</div>
<p>The Sinkhorn algorithm solves the Entropic Regularized OT problem. The
regularization strength can be controlled with the <code class="code docutils literal notranslate"><span class="pre">reg</span></code> parameter.
The Sinkhorn algorithm can be faster than the exact OT solver for large
regularization strength but the solution is only an approximation of the
exact OT problem and the OT plan is not sparse.</p>
</section>
<section id="quadratic-regularized-ot">
<h3>Quadratic Regularized OT<a class="headerlink" href="#quadratic-regularized-ot" title="Link to this heading"></a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use quadratic regularization</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_quad</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">reg_type</span><span class="o">=</span><span class="s2">&quot;L2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>

<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_quad</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">reg_type</span><span class="o">=</span><span class="s2">&quot;L2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_009.png" srcset="../_images/sphx_glr_plot_quickstart_guide_009.png" alt="OT plan loss=5.292, Sinkhorn plan loss=5.566, Quadratic reg plan loss=5.342" class = "sphx-glr-single-img"/><p>We plot above the OT plans obtained with different regularizations. The
quadratic regularization is another common choice for regularized OT and
preserves the sparsity of the OT plan.</p>
</section>
<section id="solve-the-regularized-ot-problem-with-user-defined-regularization">
<h3>Solve the Regularized OT problem with user-defined regularization<a class="headerlink" href="#solve-the-regularized-ot-problem-with-user-defined-regularization" title="Link to this heading"></a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a custom regularization function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="numpy.sum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><span class="n">G</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">df</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">G</span>


<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_reg</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">reg_type</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span><span class="o">.</span><span class="n">plan</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_010.png" srcset="../_images/sphx_glr_plot_quickstart_guide_010.png" alt="User-defined reg plan" class = "sphx-glr-single-img"/><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The examples above use the unified API of POT. The classic API is still available
and and the entropic OT plan and loss can be computed with the
<a class="reference internal" href="../all.html#ot.sinkhorn" title="ot.sinkhorn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.sinkhorn()</span></code></a> # and <a class="reference internal" href="../all.html#ot.sinkhorn2" title="ot.sinkhorn2"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.sinkhorn2()</span></code></a> functions as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Gs</span> <span class="o">=</span> <a href="../all.html#ot.sinkhorn" title="ot.sinkhorn" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">sinkhorn</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_sink</span></a> <span class="o">=</span> <a href="../all.html#ot.sinkhorn2" title="ot.sinkhorn2" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">sinkhorn2</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>
</div>
<p>For quadratic regularization, the <a class="reference internal" href="../gen_modules/ot.smooth.html#id27" title="ot.smooth.smooth_ot_dual"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.smooth.smooth_ot_dual()</span></code></a> function
can be used to compute the solution of the regularized OT problem. For
user-defined regularization, the <a class="reference internal" href="../gen_modules/ot.optim.html#id0" title="ot.optim.cg"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.optim.cg()</span></code></a> function can be used
to solve the regularized OT problem with Conditional Gradient algorithm.</p>
</div>
</section>
</section>
<section id="unbalanced-and-partial-ot">
<h2>Unbalanced and Partial OT<a class="headerlink" href="#unbalanced-and-partial-ot" title="Link to this heading"></a></h2>
<section id="unbalanced-optimal-transport">
<h3>Unbalanced Optimal Transport<a class="headerlink" href="#unbalanced-optimal-transport" title="Link to this heading"></a></h3>
<p>Unbalanced OT relaxes the marginal constraints and allows for the source and
target total weights to be different. The <a class="reference internal" href="../all.html#ot.solve_sample" title="ot.solve_sample"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.solve_sample()</span></code></a> function can be
used to solve the unbalanced OT problem by setting the marginal penalization
<code class="code docutils literal notranslate"><span class="pre">unbalanced</span></code> parameter to a positive value.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the unbalanced OT problem with KL penalization</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_unb_kl</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">unbalanced</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>

<span class="c1"># Unbalanced with KL penalization ad KL regularization</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_unb_kl_reg</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">unbalanced</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-1</span>
<span class="p">)</span><span class="o">.</span><span class="n">plan</span>  <span class="c1"># also regularized</span>

<span class="c1"># Unbalanced with L2 penalization</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_unb_l2</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">unbalanced</span><span class="o">=</span><span class="mf">7e1</span><span class="p">,</span> <span class="n">unbalanced_type</span><span class="o">=</span><span class="s2">&quot;L2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_011.png" srcset="../_images/sphx_glr_plot_quickstart_guide_011.png" alt="Unbalanced KL plan, Unbalanced KL + reg plan, Unbalanced L2 plan" class = "sphx-glr-single-img"/><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Solving the unbalanced OT problem with the classic API can be done with the
<a class="reference internal" href="../gen_modules/ot.unbalanced.html#ot.unbalanced.sinkhorn_unbalanced" title="ot.unbalanced.sinkhorn_unbalanced"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.unbalanced.sinkhorn_unbalanced()</span></code></a> function as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">G_unb_kl</span> <span class="o">=</span> <a href="../all.html#ot.sinkhorn_unbalanced" title="ot.sinkhorn_unbalanced" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">unbalanced</span><span class="o">.</span><span class="n">sinkhorn_unbalanced</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">reg</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="n">unbalanced</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="partial-optimal-transport">
<h3>Partial Optimal Transport<a class="headerlink" href="#partial-optimal-transport" title="Link to this heading"></a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the Unbalanced OT problem with TV penalization (equivalent)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_part_pen</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">unbalanced</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">unbalanced_type</span><span class="o">=</span><span class="s2">&quot;TV&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>

<span class="c1"># Solve the Partial OT problem with mass constraints (only classic API)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_part_const</span></a> <span class="o">=</span> <a href="../gen_modules/ot.partial.html#id34" title="ot.partial.partial_wasserstein" class="sphx-glr-backref-module-ot-partial sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">partial</span><span class="o">.</span><span class="n">partial_wasserstein</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># 50% mass transported</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_012.png" srcset="../_images/sphx_glr_plot_quickstart_guide_012.png" alt="Partial TV plan, Partial 50% mass plan" class = "sphx-glr-single-img"/></section>
</section>
<section id="gromov-wasserstein-and-fused-gromov-wasserstein">
<h2>Gromov-Wasserstein and Fused Gromov-Wasserstein<a class="headerlink" href="#gromov-wasserstein-and-fused-gromov-wasserstein" title="Link to this heading"></a></h2>
<section id="gromov-wasserstein-and-entropic-gw">
<h3>Gromov-Wasserstein and Entropic GW<a class="headerlink" href="#gromov-wasserstein-and-entropic-gw" title="Link to this heading"></a></h3>
<p>The Gromov-Wasserstein distance is a similarity measure between metric
measure spaces. So it does not require the samples to be in the same space.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the metric cost matrices in each spaces</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a> <span class="o">=</span> <a href="../all.html#ot.dist" title="ot.dist" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">dist</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a> <span class="o">=</span> <a href="../all.html#ot.dist" title="ot.dist" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">dist</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;sqeuclidean&quot;</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a> <span class="o">/=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a> <span class="o">/=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># Solve the Gromov-Wasserstein problem</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol_gw</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_gromov" title="ot.solve_gromov" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_gromov</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_gw</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id37" title="ot.utils.OTResult.plan" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol_gw</span><span class="o">.</span><span class="n">plan</span></a>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_gw</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id43" title="ot.utils.OTResult.value" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol_gw</span><span class="o">.</span><span class="n">value</span></a>  <span class="c1"># quadratic + reg if reg&gt;0</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_gw_quad</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id45" title="ot.utils.OTResult.value_quad" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol_gw</span><span class="o">.</span><span class="n">value_quad</span></a>  <span class="c1"># quadratic part of loss</span>

<span class="c1"># Solve the Entropic Gromov-Wasserstein problem</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_egw</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_gromov" title="ot.solve_gromov" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_gromov</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_013.png" srcset="../_images/sphx_glr_plot_quickstart_guide_013.png" alt="GW plan, Entropic GW plan" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/circleci/project/ot/bregman/_sinkhorn.py:667: UserWarning: Sinkhorn did not converge. You might want to increase the number of iterations `numItermax` or the regularization parameter `reg`.
  warnings.warn(
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Gromov-Wasserstein problem can be solved with the classic API using the
<a class="reference internal" href="../gen_modules/ot.gromov.html#ot.gromov.gromov_wasserstein" title="ot.gromov.gromov_wasserstein"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.gromov.gromov_wasserstein()</span></code></a> function and the Entropic
Gromov-Wasserstein problem can be solved with the
<a class="reference internal" href="../gen_modules/ot.gromov.html#ot.gromov.entropic_gromov_wasserstein" title="ot.gromov.entropic_gromov_wasserstein"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.gromov.entropic_gromov_wasserstein()</span></code></a> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_gw</span></a> <span class="o">=</span> <a href="../all.html#ot.gromov_wasserstein" title="ot.gromov_wasserstein" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">gromov_wasserstein</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_egw</span></a> <span class="o">=</span> <a href="../gen_modules/ot.gromov.html#ot.gromov.entropic_gromov_wasserstein" title="ot.gromov.entropic_gromov_wasserstein" class="sphx-glr-backref-module-ot-gromov sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">entropic_gromov_wasserstein</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">reg</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_gw</span></a> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">gromov_wasserstein2</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">)</span>
<span class="n">loss_egw</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">entropic_gromov_wasserstein2</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">reg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="fused-gromov-wasserstein">
<h3>Fused Gromov-Wasserstein<a class="headerlink" href="#fused-gromov-wasserstein" title="Link to this heading"></a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cost matrix</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.max.html#numpy.max" title="numpy.max" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">max</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">)</span>

<span class="c1"># Solve FGW problem with alpha=0.1</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_gromov" title="ot.solve_gromov" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_gromov</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_fgw</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id37" title="ot.utils.OTResult.plan" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">plan</span></a>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_fgw</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id43" title="ot.utils.OTResult.value" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value</span></a>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_fgw_linear</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id44" title="ot.utils.OTResult.value_linear" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value_linear</span></a>  <span class="c1"># linear part of loss (wrt M)</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_fgw_quad</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id45" title="ot.utils.OTResult.value_quad" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">value_quad</span></a>  <span class="c1"># quadratic part of loss (wrt C1 and C2)</span>

<span class="c1"># Solve entropic FGW problem with alpha=0.1</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_efgw</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_gromov" title="ot.solve_gromov" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_gromov</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_014.png" srcset="../_images/sphx_glr_plot_quickstart_guide_014.png" alt="FGW plan, Entropic FGW plan" class = "sphx-glr-single-img"/><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Fused Gromov-Wasserstein problem can be solved with the classic API using
the <a class="reference internal" href="../gen_modules/ot.gromov.html#ot.gromov.fused_gromov_wasserstein" title="ot.gromov.fused_gromov_wasserstein"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.gromov.fused_gromov_wasserstein()</span></code></a> function and the Entropic
Fused Gromov-Wasserstein problem can be solved with the
<a class="reference internal" href="../gen_modules/ot.gromov.html#ot.gromov.entropic_fused_gromov_wasserstein" title="ot.gromov.entropic_fused_gromov_wasserstein"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.gromov.entropic_fused_gromov_wasserstein()</span></code></a> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_fgw</span></a> <span class="o">=</span> <a href="../all.html#ot.fused_gromov_wasserstein" title="ot.fused_gromov_wasserstein" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">fused_gromov_wasserstein</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_efgw</span></a> <span class="o">=</span> <a href="../gen_modules/ot.gromov.html#ot.gromov.entropic_fused_gromov_wasserstein" title="ot.gromov.entropic_fused_gromov_wasserstein" class="sphx-glr-backref-module-ot-gromov sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">entropic_fused_gromov_wasserstein</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">reg</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">loss_fgw</span></a> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">fused_gromov_wasserstein2</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">loss_efgw</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">gromov</span><span class="o">.</span><span class="n">entropic_fused_gromov_wasserstein2</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">M</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">reg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="large-scale-ot">
<h2>Large scale OT<a class="headerlink" href="#large-scale-ot" title="Link to this heading"></a></h2>
<p>We discuss here strategies to solve large scale OT problems using approximations
of the exact OT problem.</p>
<section id="large-scale-sinkhorn">
<h3>Large scale Sinkhorn<a class="headerlink" href="#large-scale-sinkhorn" title="Link to this heading"></a></h3>
<p>When having samples with a large number of points, the Sinkhorn algorithm can
be implemented in a Lazy version which is more memory efficient and avoids
the computation of the <span class="math notranslate nohighlight">\(n \times m\)</span> cost matrix.</p>
<p>POT provides two implementation of the lazy Sinkhorn algorithm that return their
results in a lazy form of type <a class="reference internal" href="../gen_modules/ot.utils.html#id15" title="ot.utils.LazyTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ot.utils.LazyTensor</span></code></a>. This object can be
used to compute the loss or the OT plan in a lazy way or to recover its values
in a dense form.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the Sinkhorn problem in a lazy way</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Solve the sinkhoorn in a lazy way with geomloss</span>
<a href="../gen_modules/ot.utils.html#id16" title="ot.utils.OTResult" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sol_geo</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;geomloss&quot;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># get the OT lazy plan and loss</span>
<a href="../gen_modules/ot.utils.html#id15" title="ot.utils.LazyTensor" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_sink_lazy</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id32" title="ot.utils.OTResult.lazy_plan" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-property"><span class="n">sol</span><span class="o">.</span><span class="n">lazy_plan</span></a>

<span class="c1"># recover values for Lazy plan</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P12</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id15" title="ot.utils.LazyTensor" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_sink_lazy</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P1dots</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id15" title="ot.utils.LazyTensor" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_sink_lazy</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="c1"># convert to dense matrix !!warning this can be memory consuming</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_sink_lazy_dense</span></a> <span class="o">=</span> <a href="../gen_modules/ot.utils.html#id15" title="ot.utils.LazyTensor" class="sphx-glr-backref-module-ot-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_sink_lazy</span></a><span class="p">[:]</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_quickstart_guide_015.png" srcset="../_images/sphx_glr_plot_quickstart_guide_015.png" alt="Lazy Sinkhorn OT plan" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_quickstart_guide_016.png" srcset="../_images/sphx_glr_plot_quickstart_guide_016.png" alt="Lazy Sinkhorn OT plan" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/circleci/project/ot/bregman/_empirical.py:253: UserWarning: Sinkhorn did not converge. You might want to increase the number of iterations `numItermax` or the regularization parameter `reg`.
  warnings.warn(
[KeOps] Generating code for Max_SumShiftExpWeight_Reduction reduction (with parameters 0) of formula [c-1/2*(d*Sum((a-b)**2)),1] with a=Var(0,2,0), b=Var(1,2,1), c=Var(2,1,1), d=Var(3,1,2) ... OK
[pyKeOps] Compiling pykeops cpp 9534d93517 module ... OK
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The lazy Sinkhorn algorithm can be found in the classic API with the
<a class="reference internal" href="../gen_modules/ot.bregman.html#ot.bregman.empirical_sinkhorn" title="ot.bregman.empirical_sinkhorn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.bregman.empirical_sinkhorn()</span></code></a> function with parameter
<code class="code docutils literal notranslate"><span class="pre">lazy=True</span></code>. Similarly the geoloss implementation is available
with the <a class="reference internal" href="../gen_modules/ot.bregman.html#ot.bregman.empirical_sinkhorn2_geomloss" title="ot.bregman.empirical_sinkhorn2_geomloss"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.bregman.empirical_sinkhorn2_geomloss()</span></code></a>.</p>
</div>
<p>the first example shows how to solve the Sinkhorn problem in a lazy way with
the default POT implementation. The second example shows how to solve the
Sinkhorn problem in a lazy way with the PyKeops/Geomloss implementation that provides
a very efficient way to solve large scale problems on low dimensionality
samples.</p>
</section>
<section id="factored-and-low-rank-ot">
<h3>Factored and Low rank OT<a class="headerlink" href="#factored-and-low-rank-ot" title="Link to this heading"></a></h3>
<p>The Sinkhorn algorithm can be implemented in a low rank version that
approximates the OT plan with a low rank matrix. This can be useful to
accelerate the computation of the OT plan for large scale problems.
A similar non-regularized version of low rank factorization is also available.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve the Factored OT problem (use lazy=True for large scale)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_fact</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;factored&quot;</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">P_lowrank</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">reg</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;lowrank&quot;</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plan</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_quickstart_guide_017.png" srcset="../_images/sphx_glr_plot_quickstart_guide_017.png" alt="Factored OT plan, Low rank OT plan" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_quickstart_guide_018.png" srcset="../_images/sphx_glr_plot_quickstart_guide_018.png" alt="Factored OT plan, Low rank OT plan" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The factored OT problem can be solved with the classic API using the
<a class="reference internal" href="../gen_modules/ot.factored.html#id0" title="ot.factored.factored_optimal_transport"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.factored.factored_optimal_transport()</span></code></a> function and the low rank
OT problem can be solved with the <a class="reference internal" href="../gen_modules/ot.lowrank.html#id4" title="ot.lowrank.lowrank_sinkhorn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.lowrank.lowrank_sinkhorn()</span></code></a> function.</p>
</div>
</section>
<section id="gaussian-ot-with-bures-wasserstein">
<h3>Gaussian OT with Bures-Wasserstein<a class="headerlink" href="#gaussian-ot-with-bures-wasserstein" title="Link to this heading"></a></h3>
<p>The Gaussian Wasserstein  or Bures-Wasserstein distance is the Wasserstein distance
between Gaussian distributions. It can be used as an approximation of the
Wasserstein distance between empirical distributions by estimating the
covariance matrices of the samples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the Bures-Wasserstein distance</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">bw_value</span></a> <span class="o">=</span> <a href="../all.html#ot.solve_sample" title="ot.solve_sample" class="sphx-glr-backref-module-ot sphx-glr-backref-type-py-function"><span class="n">ot</span><span class="o">.</span><span class="n">solve_sample</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b</span></a><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exact OT loss = </span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a><span class="si">:</span><span class="s2">1.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bures-Wasserstein distance = </span><span class="si">{</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">bw_value</span></a><span class="si">:</span><span class="s2">1.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Exact OT loss = 5.292
Bures-Wasserstein distance = 4.558
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Gaussian Wasserstein problem can be solved with the classic API using the
<a class="reference internal" href="../gen_modules/ot.gaussian.html#id46" title="ot.gaussian.empirical_bures_wasserstein_distance"><code class="xref py py-func docutils literal notranslate"><span class="pre">ot.gaussian.empirical_bures_wasserstein_distance()</span></code></a> function.</p>
</div>
</section>
</section>
<section id="comparing-all-ot-plans">
<h2>Comparing all OT plans<a class="headerlink" href="#comparing-all-ot-plans" title="Link to this heading"></a></h2>
<p>The figure below shows all the OT plans computed in this example.
The color intensity represents the amount of mass transported
between the samples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot all plans</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_quickstart_guide_019.png" srcset="../_images/sphx_glr_plot_quickstart_guide_019.png" alt="OT plan, Sinkhorn plan, Quadratic reg. plan, Unbalanced KL plan, Unbalanced KL + reg plan, Unbalanced L2 plan, Partial 50% mass plan, Factored OT plan, Low rank OT plan, GW plan, Entropic GW plan, Fused GW plan" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 17.547 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-quickstart-guide-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a1042aa77b5b8566cd13383cbe37525c/plot_quickstart_guide.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_quickstart_guide.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4e8ba0723a00c7837687049bcb79ba42/plot_quickstart_guide.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_quickstart_guide.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5615e4bdabd8b69d37b660b2405c2477/plot_quickstart_guide.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_quickstart_guide.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="POT: Python Optimal Transport" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="index.html" class="btn btn-neutral float-right" title="Examples gallery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2023, POT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note"
aria-label="versions">
  <!--  add shift_up to the class for force viewing ,
  data-toggle="rst-current-version" -->
    <span class="rst-current-version"  style="margin-bottom:1mm;">
      <span class="fa fa-book"> Python Optimal Transport</span> 0.9.6dev0
      <hr  style="margin-bottom:1.5mm;margin-top:5mm;">
     <!--  versions
      <span class="fa fa-caret-down"></span>-->
      <span class="rst-current-version" style="display: inline-block;padding:
      0px;color:#fcfcfcab;float:left;font-size: 100%;">
        Versions: 
        <a href="https://pythonot.github.io/" 
        style="padding: 3px;color:#fcfcfc;font-size: 100%;">Release</a>
        <a href="https://pythonot.github.io/master" 
        style="padding: 3px;color:#fcfcfc;font-size: 100%;">Development</a>
        <a href="https://github.com/PythonOT/POT"
        style="padding: 3px;color:#fcfcfc;font-size: 100%;">Code</a>

      </span>

     
    </span>
  
     <!--
    <div class="rst-other-versions">

      

<div class="injected">

    
  <dl>
    <dt>Versions</dt>

    <dd><a href="https://pythonot.github.io/">Release</a></dd>
    
    <dd><a href="https://pythonot.github.io/master">Development</a></dd>
   
    

    <dt><a href="https://github.com/PythonOT/POT">Code on Github</a></dt>       

    
  </dl>
  <hr>

</div> 
</div>-->
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>