:orphan:

Examples gallery
================

This is a gallery of all the POT example files. 


OT and regularized OT
---------------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of EMD and Sinkhorn transport plans and their visualization.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_OT_1D_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_OT_1D.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Optimal Transport for 1D distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of Smooth and Sparse (KL an L2 reg.) OT and sparsity-constrained OT, together with their visualizations.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_OT_1D_smooth_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_OT_1D_smooth.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Smooth and sparse OT example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustrates the use of the generic solver for regularized OT with user-designed regularization term. It uses Conditional gradient as in [6] and generalized Conditional Gradient as proposed in [5,7].">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_optim_OTreg_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_optim_OTreg.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Regularized OT with generic solver</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of 2D optimal transport between distributions that are weighted sum of Diracs. The OT matrix is plotted with the samples.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_OT_2D_samples_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_OT_2D_samples.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Optimal Transport between 2D empirical distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Shows how to compute multiple Wasserstein and Sinkhorn with two different ground metrics and plot their values for different distributions.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_compute_emd_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_compute_emd.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT distances in 1D</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Shows how to compute the Wasserstein distance on the circle">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_compute_wasserstein_circle_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_compute_wasserstein_circle.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT distance on the Circle</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the solutions returns for diffrent variants of exact, regularized and unbalanced OT solvers.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_solve_variants_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_solve_variants.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Optimal Transport solvers comparison</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="2D OT on empirical distribution with different ground metric.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_OT_L1_vs_L2_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_OT_L1_vs_L2.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Optimal Transport with different ground metrics</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example gives an introduction on how to use Optimal Transport in Python.">

.. only:: html

  .. image:: /auto_examples/images/thumb/sphx_glr_plot_Intro_OT_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_plot_Intro_OT.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Introduction to Optimal Transport with Python</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/plot_OT_1D
   /auto_examples/plot_OT_1D_smooth
   /auto_examples/plot_optim_OTreg
   /auto_examples/plot_OT_2D_samples
   /auto_examples/plot_compute_emd
   /auto_examples/plot_compute_wasserstein_circle
   /auto_examples/plot_solve_variants
   /auto_examples/plot_OT_L1_vs_L2
   /auto_examples/plot_Intro_OT



POT backend examples
--------------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example we estimate mixing parameters from distributions that minimize the Wasserstein distance. In other words we suppose that a target distribution \mu^t can be expressed as a weighted sum of source distributions \mu^s_k with the following model:">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_unmix_optim_torch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_unmix_optim_torch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Wasserstein unmixing with PyTorch</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Here, we aim at transforming samples into a uniform distribution on the sphere by minimizing SSW:">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_ssw_unif_torch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_ssw_unif_torch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Spherical Sliced-Wasserstein Embedding on Sphere</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Dual OT solvers for entropic and quadratic regularized OT with Pytorch">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_dual_ot_pytorch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_dual_ot_pytorch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Dual OT solvers for entropic and quadratic regularized OT with Pytorch</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this small example, we consider the following minimization problem:">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_wass1d_torch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_wass1d_torch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Wasserstein 1D (flow and barycenter) with PyTorch</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example we train a Wasserstein GAN using Wasserstein 2 on minibatches as a distribution fitting term.">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_wass2_gan_torch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_wass2_gan_torch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Wasserstein 2 Minibatch GAN with PyTorch</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example we use the pytorch backend to optimize the sliced Wasserstein loss between two empirical distributions [31].">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_sliced_wass_grad_flow_pytorch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_sliced_wass_grad_flow_pytorch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Sliced Wasserstein barycenter and gradient flow with PyTorch</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Continuous OT plan estimation with Pytorch">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_stoch_continuous_ot_pytorch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_stoch_continuous_ot_pytorch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Continuous OT plan estimation with Pytorch</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we use the pytorch backend to optimize the Gromov-Wasserstein (GW) loss between two graphs expressed as empirical distribution.">

.. only:: html

  .. image:: /auto_examples/backends/images/thumb/sphx_glr_plot_optim_gromov_pytorch_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_backends_plot_optim_gromov_pytorch.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Optimizing the Gromov-Wasserstein distance with PyTorch</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/backends/plot_unmix_optim_torch
   /auto_examples/backends/plot_ssw_unif_torch
   /auto_examples/backends/plot_dual_ot_pytorch
   /auto_examples/backends/plot_wass1d_torch
   /auto_examples/backends/plot_wass2_gan_torch
   /auto_examples/backends/plot_sliced_wass_grad_flow_pytorch
   /auto_examples/backends/plot_stoch_continuous_ot_pytorch
   /auto_examples/backends/plot_optim_gromov_pytorch



Wasserstein barycenters
-----------------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to illustrate how the Convolutional Wasserstein Barycenter function of POT works.">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_convolutional_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_convolutional_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Convolutional Wasserstein Barycenter example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of 2D Wasserstein and Sinkhorn barycenters if distributions are weighted sum of Diracs.">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_free_support_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_free_support_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">2D free support Wasserstein barycenters of distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of Gaussian Bures-Wasserstein barycenters.">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_gaussian_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_gaussian_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Gaussian Bures-Wasserstein barycenters</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of regularized Wasserstein Barycenter as proposed in [3].">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_barycenter_1D_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_barycenter_1D.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">1D Wasserstein barycenter demo</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of the debiased Sinkhorn barycenter as proposed in [37]_.">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_debiased_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_debiased_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Debiased Sinkhorn barycenter demo</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of Generalized Wasserstein Barycenter as proposed in [42].">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_generalized_free_support_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_generalized_free_support_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Generalized Wasserstein Barycenter Demo</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of Sinkhorn barycenter calculation between empirical distributions understood as point clouds">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_free_support_sinkhorn_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_free_support_sinkhorn_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">2D free support Sinkhorn barycenters of distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of regularized Wasserstein Barycenter as proposed in [3] and exact LP barycenters using standard LP solver.">

.. only:: html

  .. image:: /auto_examples/barycenters/images/thumb/sphx_glr_plot_barycenter_lp_vs_entropic_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_barycenters_plot_barycenter_lp_vs_entropic.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">1D Wasserstein barycenter: exact LP vs entropic regularization</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/barycenters/plot_convolutional_barycenter
   /auto_examples/barycenters/plot_free_support_barycenter
   /auto_examples/barycenters/plot_gaussian_barycenter
   /auto_examples/barycenters/plot_barycenter_1D
   /auto_examples/barycenters/plot_debiased_barycenter
   /auto_examples/barycenters/plot_generalized_free_support_barycenter
   /auto_examples/barycenters/plot_free_support_sinkhorn_barycenter
   /auto_examples/barycenters/plot_barycenter_lp_vs_entropic




Domain adaptation examples
--------------------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example introduces a domain adaptation in a 2D setting and OTDA approach with Laplacian regularization.">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_laplacian_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_laplacian.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT with Laplacian regularization for domain adaptation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example presents a way of transferring colors between two images with Optimal Transport as introduced in [6]">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_color_images_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_color_images.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT for image color adaptation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example presents how to use MappingTransport to estimate at the same time both the coupling transport and approximate the transport map with either a linear or a kernelized mapping as introduced in [8].">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_mapping_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_mapping.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT mapping estimation for domain adaptation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="OT for domain adaptation with image color adaptation [6] with mapping estimation [8].">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_mapping_colors_images_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_mapping_colors_images.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT for image color adaptation with mapping estimation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example introduces a semi supervised domain adaptation in a 2D setting. It explicits the problem of semi supervised domain adaptation and introduces some optimal transport approaches to solve it.">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_semi_supervised_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_semi_supervised.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OTDA unsupervised vs semi-supervised setting</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Linear OT mapping estimation">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_linear_mapping_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_linear_mapping.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Linear OT mapping estimation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example introduces a domain adaptation in a 2D setting and the 4 OTDA approaches currently supported in POT.">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_classes_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_classes.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT for domain adaptation</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example introduces a domain adaptation in a 2D setting. It explicits the problem of domain adaptation and introduces some optimal transport approaches to solve it.">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_d2_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_d2.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT for domain adaptation on empirical distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example introduces a target shift problem with two 2D source and 1 target domain.">

.. only:: html

  .. image:: /auto_examples/domain-adaptation/images/thumb/sphx_glr_plot_otda_jcpot_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_domain-adaptation_plot_otda_jcpot.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">OT for multi-source target shift</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/domain-adaptation/plot_otda_laplacian
   /auto_examples/domain-adaptation/plot_otda_color_images
   /auto_examples/domain-adaptation/plot_otda_mapping
   /auto_examples/domain-adaptation/plot_otda_mapping_colors_images
   /auto_examples/domain-adaptation/plot_otda_semi_supervised
   /auto_examples/domain-adaptation/plot_otda_linear_mapping
   /auto_examples/domain-adaptation/plot_otda_classes
   /auto_examples/domain-adaptation/plot_otda_d2
   /auto_examples/domain-adaptation/plot_otda_jcpot



Gromov and Fused-Gromov-Wasserstein
-----------------------------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example first illustrates the computation of FGW for 1D measures estimated using a Conditional Gradient solver [24].">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_fgw_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_fgw.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Plot Fused-Gromov-Wasserstein</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="[12] Gabriel Peyré, Marco Cuturi, and Justin Solomon (2016), &quot;Gromov-Wasserstein averaging of kernel and distance matrices&quot;. International Conference on Machine Learning (ICML).">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_gromov_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_gromov.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Gromov-Wasserstein example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation barycenter of labeled graphs using FGW [18].">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_barycenter_fgw_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_barycenter_fgw.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Plot graphs barycenter using FGW</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use the Gromov-Wasserstein distance computation in POT.">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_gromov_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_gromov_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Gromov-Wasserstein Barycenter example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example first illustrates how to train a graph classification gnn based on the Template Fused Gromov Wasserstein layer as proposed in [52] .">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_gnn_TFGW_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_gnn_TFGW.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Graph classification with Tempate Based Fused Gromov Wasserstein</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we illustrate how to learn a semi-relaxed Gromov-Wasserstein (srGW) barycenter using a Block-Coordinate Descent algorithm, on a dataset of structured data such as graphs, denoted \{ \mathbf{C_s} \}_{s \in [S]} where every nodes have uniform weights \{ \mathbf{p_s} \}_{s \in [S]}. Given a barycenter structure matrix \mathbf{C} with N nodes, each graph (\mathbf{C_s}, \mathbf{p_s}) is modeled as a reweighed subgraph with structure \mathbf{C} and weights \mathbf{w_s} \in \Sigma_N where each \mathbf{w_s} corresponds to the second marginal of the OT \mathbf{T_s} (s.t \mathbf{w_s} = \mathbf{T_s}^\top \mathbf{1}) minimizing the srGW loss between the s^{th} input and the barycenter.">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_semirelaxed_gromov_wasserstein_barycenter_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_semirelaxed_gromov_wasserstein_barycenter.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Semi-relaxed (Fused) Gromov-Wasserstein Barycenter as Dictionary Learning</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use the semi-relaxed Gromov-Wasserstein and the semi-relaxed Fused Gromov-Wasserstein divergences.">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_semirelaxed_fgw_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_semirelaxed_fgw.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Semi-relaxed (Fused) Gromov-Wasserstein example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use the entropic semi-relaxed Gromov-Wasserstein and the entropic semi-relaxed Fused Gromov-Wasserstein divergences.">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_entropic_semirelaxed_fgw_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_entropic_semirelaxed_fgw.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Entropic-regularized semi-relaxed (Fused) Gromov-Wasserstein example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we illustrate how to learn a Gromov-Wasserstein dictionary on a dataset of structured data such as graphs, denoted \{ \mathbf{C_s} \}_{s \in [S]} where every nodes have uniform weights. Given a dictionary \mathbf{C_{dict}} composed of D structures of a fixed size nt, each graph (\mathbf{C_s}, \mathbf{p_s}) is modeled as a convex combination \mathbf{w_s} \in \Sigma_D of these dictionary atoms as \sum_d w_{s,d} \mathbf{C_{dict}[d]}.">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_gromov_wasserstein_dictionary_learning_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_gromov_wasserstein_dictionary_learning.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">(Fused) Gromov-Wasserstein Linear Dictionary Learning</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of FGW for attributed graphs using 4 different solvers to estimate the distance based on Conditional Gradient [24], Sinkhorn projections [12, 51] and alternated Bregman projections [63, 64].">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_fgw_solvers_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_fgw_solvers.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Comparison of Fused Gromov-Wasserstein solvers</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="These examples show how to use the quantized (Fused) Gromov-Wasserstein solvers (qFGW) [68]. POT provides a generic solver quantized_fused_gromov_wasserstein_partitioned that takes as inputs partitioned graphs potentially endowed with node features, which have to be built by the user. On top of that, POT provides two wrappers:     i) quantized_fused_gromov_wasserstein operating over generic graphs, whose     partitioning is performed via get_graph_partition using e.g the Louvain algorithm,     and representant for each partition can be selected via get_graph_representants     using e.g the PageRank algorithm.">

.. only:: html

  .. image:: /auto_examples/gromov/images/thumb/sphx_glr_plot_quantized_gromov_wasserstein_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_gromov_plot_quantized_gromov_wasserstein.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Quantized Fused Gromov-Wasserstein examples</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/gromov/plot_fgw
   /auto_examples/gromov/plot_gromov
   /auto_examples/gromov/plot_barycenter_fgw
   /auto_examples/gromov/plot_gromov_barycenter
   /auto_examples/gromov/plot_gnn_TFGW
   /auto_examples/gromov/plot_semirelaxed_gromov_wasserstein_barycenter
   /auto_examples/gromov/plot_semirelaxed_fgw
   /auto_examples/gromov/plot_entropic_semirelaxed_fgw
   /auto_examples/gromov/plot_gromov_wasserstein_dictionary_learning
   /auto_examples/gromov/plot_fgw_solvers
   /auto_examples/gromov/plot_quantized_gromov_wasserstein




Other OT problems
-----------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of Screenkhorn [26].">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_screenkhorn_1D_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_screenkhorn_1D.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Screened optimal transport (Screenkhorn)</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of 2D optimal transport between distributions that are weighted sum of Diracs. The OT matrix is plotted with the samples.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_WeakOT_VS_OT_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_WeakOT_VS_OT.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Weak Optimal Transport VS exact Optimal Transport</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of the factored coupling OT between 2D empirical distributions">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_factored_coupling_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_factored_coupling.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Optimal transport with factored couplings</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use the CO-Optimal Transport [47]_ in POT. CO-Optimal Transport allows to calculate the distance between two arbitrary-size matrices, and to align their rows and columns. In this example, we consider two random matrices X_1 and X_2 defined by (X_1)_{i,j} = \cos(\frac{i}{n_1} \pi) + \cos(\frac{j}{d_1} \pi) + \sigma \mathcal N(0,1) and (X_2)_{i,j} = \cos(\frac{i}{n_2} \pi) + \cos(\frac{j}{d_2} \pi) + \sigma \mathcal N(0,1).">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_COOT_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_COOT.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Row and column alignments with CO-Optimal Transport</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of Low Rank Sinkhorn [26].">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_lowrank_sinkhorn_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_lowrank_sinkhorn.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Low rank Sinkhorn</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrate the use of WDA as proposed in [11].">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_WDA_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_WDA.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Wasserstein Discriminant Analysis</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of the GMM plan for the Mixture Wasserstein between two GMM in 1D, as well as the two maps T_mean and T_rand. T_mean is the barycentric projection of the GMM coupling, and T_rand takes a random gaussian image between two components, according to the coupling and the GMMs. See [69] for details. .. [69] Delon, J., &amp; Desolneux, A. (2020). A Wasserstein-type distance in the space of Gaussian mixture models. SIAM Journal on Imaging Sciences, 13(2), 936-970.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_GMMOT_plan_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_GMMOT_plan.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">GMM Plan 1D</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use the stochastic optimization algorithms for discrete and semi-continuous measures from the POT library.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_stochastic_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_stochastic.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Stochastic examples</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example we plot the logo of the POT toolbox.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_logo_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_logo.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Logo of the POT toolbox</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use SSNB [58] in POT. SSNB computes an l-strongly convex potential \varphi with an L-Lipschitz gradient such that \nabla \varphi \# \mu \approx \nu. This regularity can be enforced only on the components of a partition of the ambient space, which is a relaxation compared to imposing global regularity.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_SSNB_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_SSNB.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Smooth and Strongly Convex Nearest Brenier Potentials</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="When the cost is discretized (Monge), the d-MMOT solver can more quickly compute and minimize the distance between many distributions without the need for intermediate barycenter computations. This example compares the time to identify, and the quality of, solutions for the d-MMOT problem using a primal/dual algorithm and classical LP barycenter approaches.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_dmmot_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_dmmot.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Computing d-dimensional Barycenters via d-MMOT</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Comparaison between entropic Gromov-Wasserstein and Low Rank Gromov Wasserstein [67] on two curves in 2D and 3D, both sampled with 200 points.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_lowrank_GW_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_lowrank_GW.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Low rank Gromov-Wasterstein between samples</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="In this example, we consider two point clouds living in different Euclidean spaces, where the outliers are artifically injected into the target data. We illustrate two methods which allow to filter out these outliers.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_outlier_detection_with_COOT_and_unbalanced_COOT_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_outlier_detection_with_COOT_and_unbalanced_COOT.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Detecting outliers by learning sample marginal distribution with CO-Optimal Transport and by using unbalanced Co-Optimal Transport</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the use of EWCA as proposed in [52].">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_EWCA_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_EWCA.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Entropic Wasserstein Component Analysis</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="Illustration of the flow of a Gaussian Mixture with respect to its GMM-OT distance with respect to a fixed GMM.">

.. only:: html

  .. image:: /auto_examples/others/images/thumb/sphx_glr_plot_GMM_flow_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_others_plot_GMM_flow.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">GMM Flow</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/others/plot_screenkhorn_1D
   /auto_examples/others/plot_WeakOT_VS_OT
   /auto_examples/others/plot_factored_coupling
   /auto_examples/others/plot_COOT
   /auto_examples/others/plot_lowrank_sinkhorn
   /auto_examples/others/plot_WDA
   /auto_examples/others/plot_GMMOT_plan
   /auto_examples/others/plot_stochastic
   /auto_examples/others/plot_logo
   /auto_examples/others/plot_SSNB
   /auto_examples/others/plot_dmmot
   /auto_examples/others/plot_lowrank_GW
   /auto_examples/others/plot_outlier_detection_with_COOT_and_unbalanced_COOT
   /auto_examples/others/plot_EWCA
   /auto_examples/others/plot_GMM_flow



Sliced Wasserstein Distance
---------------------------



.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of the sliced Wasserstein Distance as proposed in [31].">

.. only:: html

  .. image:: /auto_examples/sliced-wasserstein/images/thumb/sphx_glr_plot_variance_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sliced-wasserstein_plot_variance.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Sliced Wasserstein Distance on 2D distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of the spherical sliced Wasserstein discrepancy as proposed in [46].">

.. only:: html

  .. image:: /auto_examples/sliced-wasserstein/images/thumb/sphx_glr_plot_variance_ssw_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_sliced-wasserstein_plot_variance_ssw.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Spherical Sliced Wasserstein on distributions in S^2</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/sliced-wasserstein/plot_variance
   /auto_examples/sliced-wasserstein/plot_variance_ssw


Unbalanced and Partial OT
-------------------------


.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of Unbalanced Optimal transport using a Kullback-Leibler relaxation.">

.. only:: html

  .. image:: /auto_examples/unbalanced-partial/images/thumb/sphx_glr_plot_UOT_1D_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unbalanced-partial_plot_UOT_1D.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">1D Unbalanced optimal transport</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="UOT aims at solving the following optimization problem:">

.. only:: html

  .. image:: /auto_examples/unbalanced-partial/images/thumb/sphx_glr_plot_unbalanced_OT_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unbalanced-partial_plot_unbalanced_OT.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">2D examples of exact and entropic unbalanced optimal transport</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This examples illustrates the better convergence of the translation invariance Sinkhorn algorithm proposed in [73] compared to the classical Sinkhorn algorithm.">

.. only:: html

  .. image:: /auto_examples/unbalanced-partial/images/thumb/sphx_glr_plot_conv_sinkhorn_ti_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unbalanced-partial_plot_conv_sinkhorn_ti.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Translation Invariant Sinkhorn for Unbalanced Optimal Transport</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example illustrates the computation of regularized Wasserstein Barycenter as proposed in [10] for Unbalanced inputs.">

.. only:: html

  .. image:: /auto_examples/unbalanced-partial/images/thumb/sphx_glr_plot_UOT_barycenter_1D_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unbalanced-partial_plot_UOT_barycenter_1D.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">1D Wasserstein barycenter demo for Unbalanced distributions</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example is designed to show how to use the Partial (Gromov-)Wasserstein distance computation in POT.">

.. only:: html

  .. image:: /auto_examples/unbalanced-partial/images/thumb/sphx_glr_plot_partial_wass_and_gromov_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unbalanced-partial_plot_partial_wass_and_gromov.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Partial Wasserstein and Gromov-Wasserstein example</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="[Chapel et al., 2021] Chapel, L., Flamary, R., Wu, H., Févotte, C., and Gasso, G. (2021). Unbalanced optimal transport through non-negative penalized linear regression.">

.. only:: html

  .. image:: /auto_examples/unbalanced-partial/images/thumb/sphx_glr_plot_regpath_thumb.png
    :alt:

  :ref:`sphx_glr_auto_examples_unbalanced-partial_plot_regpath.py`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Regularization path of l2-penalized unbalanced optimal transport</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:

   /auto_examples/unbalanced-partial/plot_UOT_1D
   /auto_examples/unbalanced-partial/plot_unbalanced_OT
   /auto_examples/unbalanced-partial/plot_conv_sinkhorn_ti
   /auto_examples/unbalanced-partial/plot_UOT_barycenter_1D
   /auto_examples/unbalanced-partial/plot_partial_wass_and_gromov
   /auto_examples/unbalanced-partial/plot_regpath


.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-gallery

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download all examples in Python source code: auto_examples_python.zip </auto_examples/auto_examples_python.zip>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download all examples in Jupyter notebooks: auto_examples_jupyter.zip </auto_examples/auto_examples_jupyter.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
